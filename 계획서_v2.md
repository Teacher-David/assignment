# 영재교육원 피드백 시스템 개발 계획서

## 1. 프로젝트 개요

영재교육원 학생들의 과제물에 대해 교사가 피드백을 입력하고, 학생들이 자신의 피드백을 확인할 수 있는 웹 기반 시스템을 구축합니다.

## 2. 기술 스택

- **프론트엔드**: HTML, Tailwind CSS, JavaScript
- **백엔드**: Firebase (Authentication, Firestore Database)
- **배포**: GitHub Pages (정적 호스팅)

## 3. 주요 기능 요구사항

### 3.1. 교사 기능
- **로그인**: 아이디만 입력하면 자동으로 `@daechi.sen.es.kr` 도메인이 붙어서 로그인
- **피드백 관리**: 학생별/과제별 피드백 입력 및 수정
- **학생 명단 관리**: 2차 인증 후 학생 정보 등록/수정/삭제 (관리자 전용)
- **단일 계정**: 하나의 사전 생성된 교사 계정으로 여러 교사가 공유 사용
- **2차 인증**: 학생 명단 관리 시 추가 비밀번호 확인 (5552455)

### 3.2. 학생 기능
- **피드백 조회**: 이름 + 전화번호 입력으로 본인 정보만 조회
- **과제별 확인**: 1차, 2차, 3차 과제 피드백을 각각 확인
- **미입력 상태 표시**: 피드백이 없는 경우 "아직 피드백이 입력되지 않았습니다" 메시지 표시

### 3.3. 과제 구조
- **1차 과제**: 첫 번째 과제 피드백
- **2차 과제**: 두 번째 과제 피드백  
- **3차 과제**: 세 번째 과제 피드백

## 4. 데이터베이스 구조 (Firestore)

### 4.1. 컬렉션 설계

#### `students` 컬렉션 (메인 컬렉션)
```
students/{phoneNumber}  // 문서 ID를 전화번호로 사용
{
  class: "아리스토텔레스" 또는 "케플러",
  name: "학생이름",
  phoneNumber: "010-1234-5678",  // 문서 ID와 동일한 값
}
```

#### `feedback` 서브컬렉션 (각 학생 문서 하위)
```
students/{phoneNumber}/feedback/{assignmentId}
{
  assignment: "1차" | "2차" | "3차",
  content: "피드백 내용",
  updatedAt: timestamp,
  createdAt: timestamp
}
```

**전화번호를 문서 ID로 사용하는 장점:**
- **O(1) 검색 성능**: 전화번호로 즉시 문서 접근 가능
- **고유성 보장**: 전화번호는 자연스럽게 고유값
- **쿼리 최적화**: `where` 조건 없이 바로 문서 조회
- **보안 강화**: 정확한 전화번호를 모르면 접근 불가능

### 4.2. Firestore 보안 규칙
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // 학생 정보: 모든 사용자가 읽기 가능, 교사만 쓰기 가능
    match /students/{phoneNumber} {
      allow read: if true;  // 학생이 전화번호로 직접 문서 조회 가능
      allow write: if request.auth != null;  // 교사만 학생 정보 등록/수정 가능
      
      // 각 학생의 피드백 서브컬렉션
      match /feedback/{assignmentId} {
        allow read: if true;  // 학생이 본인 피드백을 조회할 수 있도록 허용
        allow write: if request.auth != null;  // 교사만 피드백 작성/수정 가능
      }
    }
  }
}
```

**전화번호 기반 보안의 장점:**
- 정확한 전화번호를 모르면 문서 접근 불가능
- 브루트 포스 공격에 대한 자연스러운 보호
- 추가적인 이름 검증으로 이중 보안 구현

**주의사항**: 
- 이 보안 규칙은 모든 사용자가 데이터를 읽을 수 있게 허용합니다.
- 클라이언트 사이드에서 학생이 본인 정보만 조회하도록 하는 로직이 중요합니다.
- 실제 운영 환경에서는 더 세밀한 보안 규칙을 고려해야 합니다.

## 5. 페이지 구조

### 5.1. 메인 페이지 (`index.html`)
- **학생용 피드백 조회 페이지**
- 이름, 전화번호 입력 폼
- 과제별 피드백 표시 영역

### 5.2. 교사 로그인 페이지 (`login.html`)
- 아이디 입력 필드 (자동으로 @daechi.sen.es.kr 도메인 추가)
- 비밀번호 입력 필드

### 5.3. 교사 관리 페이지 (`teacher.html`)
- **피드백 관리 탭**: 학생 검색/선택 및 과제별 피드백 입력/수정
- **명단 관리 탭**: 2차 인증 후 학생 정보 등록/수정/삭제 기능
- **2차 인증 구현**: 클라이언트 사이드에서 고정 비밀번호(5552455) 확인

## 6. 주요 기능 흐름

### 6.1. 학생 피드백 조회 흐름
1. 학생이 이름과 전화번호 입력
2. **전화번호를 문서 ID로 사용하여 직접 문서 조회** (O(1) 성능)
3. 조회된 문서의 `name` 필드와 입력된 이름이 일치하는지 검증
4. 이름이 일치하면 해당 학생의 `feedback` 서브컬렉션에서 피드백 데이터 조회
5. 1차, 2차, 3차 과제별 피드백을 각각 표시
6. 피드백이 없는 과제는 "아직 피드백이 입력되지 않았습니다" 표시

### 6.2. 교사 피드백 관리 흐름
1. 교사가 아이디 입력 (자동으로 @daechi.sen.es.kr 추가)
2. Firebase Authentication으로 로그인
3. **피드백 관리 탭**: `students` 컬렉션에서 전체 학생 목록 조회 (또는 검색)
4. 선택한 학생의 전화번호로 해당 문서에 직접 접근
5. 해당 학생의 `feedback` 서브컬렉션에서 기존 피드백 조회
6. 과제별 피드백을 해당 학생의 서브컬렉션에 저장/수정

### 6.3. 교사 명단 관리 흐름 (관리자 전용)
1. 교사 페이지에서 "명단 관리" 탭 클릭
2. **2차 인증 팝업**: 관리자 비밀번호 입력 요청
3. 클라이언트에서 입력된 비밀번호와 `5552455` 비교 검증
4. 인증 성공 시 학생 명단 관리 기능 활성화
   - 새 학생 추가 (이름, 전화번호, 반 선택)
   - 기존 학생 정보 수정
   - 학생 삭제 (피드백 데이터 포함)
5. 세션 동안 2차 인증 상태 유지 (새로고침 시 재인증 필요)

**성능 개선점:**
- 학생 조회: `O(log n)` → `O(1)` (문서 ID 직접 접근)
- 네트워크 요청 최소화: 단일 문서 조회로 학생 정보 확인
- 인덱스 불필요: 전화번호 기반 쿼리가 불필요함

## 7. 보안 고려사항

### 7.1. 학생 데이터 보호
- **클라이언트 사이드 검증**: 학생이 입력한 이름+전화번호와 일치하는 데이터만 표시
- **제한적 쿼리**: 학생은 본인의 이름과 전화번호로만 검색 가능
- **UI 레벨 보안**: 다른 학생의 정보는 UI에서 표시되지 않도록 구현

### 7.2. 교사 인증
- **1차 인증**: Firebase Authentication을 통한 단일 교사 계정 관리
- **2차 인증**: 학생 명단 관리 시 추가 비밀번호 확인 (클라이언트 사이드)
- **공유 계정**: 여러 교사가 하나의 계정으로 피드백 입력 가능
- **권한 분리**: 일반 교사(피드백만), 관리자(명단 관리 가능)

### 7.3. 2차 인증 보안 고려사항
- **클라이언트 검증**: 고정 비밀번호를 클라이언트에서 확인
- **세션 관리**: 2차 인증 상태를 세션 동안만 유지
- **재인증**: 페이지 새로고침 시 2차 인증 재요구
- **비밀번호 난독화**: JavaScript 코드에서 비밀번호 최소한 인코딩 처리

### 7.3. Firestore 보안
- **읽기 권한**: 모든 사용자에게 허용 (학생 조회를 위해 필요)
- **쓰기 권한**: 인증된 사용자(교사)만 가능
- **데이터 무결성**: 클라이언트 사이드에서 적절한 검증 로직 구현

### 7.4. 추가 보안 고려사항
- 개인정보 최소 수집 원칙 (이름, 전화번호만 저장)
- 피드백 내용의 적절성 검토
- 정기적인 데이터 백업 및 관리

## 8. GitHub Pages 배포 고려사항

### 8.1. 정적 호스팅 제약
- 서버 사이드 로직 없이 클라이언트 사이드만으로 구현
- Firebase SDK를 CDN으로 로드하여 사용

### 8.2. 파일 구조
```
/
├── index.html          # 학생용 메인 페이지
├── login.html          # 교사 로그인 페이지
├── teacher.html        # 교사 관리 페이지 (탭: 피드백관리, 명단관리)
├── css/
│   └── styles.css      # Tailwind CSS 빌드 결과
├── js/
│   ├── firebase-config.js  # Firebase 설정
│   ├── student.js          # 학생 페이지 로직
│   ├── auth.js            # 1차 인증 관련 로직
│   ├── teacher.js         # 교사 피드백 관리 로직
│   └── admin.js           # 2차 인증 및 명단 관리 로직
└── README.md
```

## 9. 개발 일정

### 1단계: 기본 구조 설정 (1일)
- HTML 페이지 구조 생성
- Tailwind CSS 설정 및 스타일링
- Firebase 프로젝트 설정

### 2단계: 학생 피드백 조회 기능 (1일)
- 학생 정보 입력 폼 구현
- 피드백 조회 로직 구현
- 과제별 피드백 표시 UI

### 3단계: 교사 관리 기능 (1일)
- 교사 로그인 기능 구현
- 학생 관리 및 피드백 입력 기능
- 데이터 저장/수정 로직

### 4단계: 테스트 및 배포 (1일)
- 기능 테스트 및 버그 수정
- GitHub Pages 배포 설정
- 샘플 데이터 입력 및 최종 테스트

## 10. 추가 고려사항

### 10.1. 사용자 경험
- 반응형 디자인으로 모바일 친화적 구현
- 로딩 상태 및 에러 메시지 표시
- 직관적인 UI/UX 디자인

### 10.2. 데이터 관리
- 학생 정보 일괄 등록 기능 (CSV 업로드 등)
- 피드백 데이터 백업 및 관리 방안

### 10.3. 향후 확장성
- 과제 수 확장 가능성 고려
- 다중 교사 지원 가능성 고려
- 통계 및 리포트 기능 추가 가능성
